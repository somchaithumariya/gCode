function NotifyDutyRoom(){
//=======‡πÉ‡∏™‡πà‡πÑ‡∏ß‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡∏¥‡∏î‡∏ñ‡∏∂‡∏á‡∏Å‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏•‡∏ö‡∏ó‡∏¥‡πâ‡∏á‡πÑ‡∏î‡πâ‡∏Ñ‡∏±‡∏ö ‡∏´‡∏≤‡∏Å‡∏ä‡πà‡∏ß‡∏¢‡πÅ‡∏ä‡∏£‡πå‡∏à‡∏±‡∏Å‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏°‡∏≤‡∏Å‡∏Ñ‡∏£‡∏±‡∏ö================
//=======================‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏ß‡∏£‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå-‡∏ß‡∏±‡∏ô‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå‡πÅ‡∏ö‡∏ö‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ==========================
//====================================‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÇ‡∏î‡∏¢========================================
//================================‡∏ô‡∏≤‡∏¢‡∏™‡∏°‡∏û‡∏á‡∏©‡πå  ‡πÇ‡∏û‡∏Ñ‡∏≤‡∏®‡∏£‡∏µ===================================
//==========‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ : 095-6659190  email: spkorat0125@gmail.com  LineI: guytrue=========
//=====‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏´‡∏ô‡∏≠‡∏á‡∏Å‡∏£‡∏≤‡∏î‡∏ß‡∏±‡∏í‡∏ô‡∏≤ ‡∏ï.‡∏´‡∏ô‡∏≠‡∏á‡∏Å‡∏£‡∏≤‡∏î ‡∏≠.‡∏î‡πà‡∏≤‡∏ô‡∏Ç‡∏∏‡∏ô‡∏ó‡∏î ‡∏à. ‡∏ô‡∏Ñ‡∏£‡∏£‡∏≤‡∏ä‡∏™‡∏µ‡∏°‡∏≤ 30210 ‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå 044-973561====
//===============‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏¥‡πÇ‡∏°‡∏à‡∏¥‡∏™‡∏ß‡∏¢ ‡πÜ  ‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡πÄ‡∏ß‡πá‡πÑ‡∏ã‡∏ï‡πå  https://getemoji.com/==================

var ss=SpreadsheetApp.getActive() //‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÉ‡∏ä‡πâ url ‡∏Ç‡∏≠‡∏á‡∏ä‡∏µ‡∏ï‡πÉ‡∏ô ss
var sht = ss.getSheetByName("data");

//========-‡∏ä‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡∏≥=============
var txtTitle1=sht.getRange(1,1).getValue();  //‡πÑ‡∏ï‡πÄ‡∏ï‡∏¥‡πâ‡∏•1
var txtTitle2=sht.getRange(3,2).getValue();  //‡πÑ‡∏ï‡πÄ‡∏ï‡∏¥‡πâ‡∏•2
var txtTitle3=sht.getRange(4,2).getValue();  //‡πÑ‡∏ï‡πÄ‡∏ï‡∏¥‡πâ‡∏•3

//============‡∏ä‡∏∏‡∏î Token===========
var token1=sht.getRange(2,2).getValue();  // token id ‡∏´‡πâ‡∏≠‡∏á 1
var token2=sht.getRange(2,5).getValue();  // token id ‡∏´‡πâ‡∏≠‡∏á 2

//============‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô=========
var daymove=sht.getRange(4,6).getValue(); 

//============‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡πà‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏î‡∏∑‡∏≠‡∏ô=========
var strWeek = ["‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå", "‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå", "‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£", "‡∏û‡∏∏‡∏ò", "‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ", "‡∏®‡∏∏‡∏Å‡∏£‡πå", "‡πÄ‡∏™‡∏≤‡∏£‡πå"]; //‡∏ü‡∏±‡∏á‡∏ä‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏´‡∏≤‡∏ß‡∏±‡∏ô‡πÉ‡∏ô‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå
var strMonthFull = ["‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°", "‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå", "‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°", "‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô", "‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°", "‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô", "‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°", "‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°", "‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô", "‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°", "‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô", "‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°"]; //‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
     
//=========‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô==============
var  e = new Date(); //‡∏Å‡∏≥‡∏´‡∏ô‡∏î d ‡πÄ‡∏Å‡πá‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ
e.setDate(e.getDate() + daymove); // ‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°
var nextday = e.getDay(); //‡∏ß‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô


var  d = new Date(); //‡∏Å‡∏≥‡∏´‡∏ô‡∏î d ‡πÄ‡∏Å‡πá‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ
var curdate=d.getDate(); // ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1-31
var daycur = d.getDay(); // ‡∏ß‡∏±‡∏ô 0-6 ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏õ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ß‡∏±‡∏ô ‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå-‡∏®‡∏∏‡∏Å‡∏£‡πå
var monthcur=d.getMonth();  //‡πÄ‡∏•‡∏Ç‡πÄ‡∏î‡∏∑‡∏≠‡∏ô 0-11 ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏õ‡∏´‡∏≤ ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°-‡∏ò‡∏±‡∏ß‡∏≤‡∏Ñ‡∏°
var yearcur =d.getFullYear()+543; //‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏µ ‡∏Ñ.‡∏®. ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô ‡∏û.‡∏®.
var MonthId = strMonthFull[monthcur]; //‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢ ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°-‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°
var curweek = strWeek[daycur]; //‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ß‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô

var CheckTitle=sht.getRange(5,nextday+2).getValue();  //‡πÄ‡∏ä‡πá‡∏Ñ‡∏Ñ‡πà‡∏≤‡∏ß‡πà‡∏≤‡∏Ñ‡πà‡∏≤‡∏ß‡∏±‡∏ô‡∏ô‡∏±‡πâ‡∏ô‡πÜ‡πÉ‡∏ä‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏ä
var CheckData=sht.getRange(6, nextday+2).getValue();  //‡πÄ‡∏ä‡πá‡∏Ñ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

if (CheckData > 0 && CheckTitle==true){ //‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà 1 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ    
        var msgtotal="";
          for (i = 1; i <=CheckData; i++) {        
                var rankcheck=sht.getRange(i+7,nextday+2 ).getValue();                               
                //var rankcheck=sht.getRange(i+7,daycur+1+nextday ).getValue();                               
                  msgtotal=msgtotal+"\n"+ rankcheck;                 
              }
                  var msg ="‚è∞ "+txtTitle1+"\n"+txtTitle2+"\n"+txtTitle3+"\nüìÜ ‡∏ß‡∏±‡∏ô "+ curweek + " ‡∏ó‡∏µ‡πà " + curdate + ' ' +MonthId + ' ‡∏û.‡∏®. ' + yearcur +"\n"+  msgtotal+'\n\n1. ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ä‡πâ‡∏≤\n2. ‡∏ô‡∏≥‡∏Ç‡∏¢‡∏∞‡πÑ‡∏õ‡∏ó‡∏¥‡πâ‡∏á\n3. ‡∏Å‡∏ß‡∏≤‡∏î‡∏û‡∏∑‡πâ‡∏ô‡∏´‡πâ‡∏≠‡∏á‡∏ù‡∏´‡∏ô‡πâ‡∏≤‡∏´‡πâ‡∏≠‡∏á\n4. ‡∏•‡∏ö‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô'
        
                  sendLineNotify(msg,token1); //‡∏™‡∏±‡πà‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà 1
                  //sendLineNotify(msg,token2); //‡∏™‡∏±‡πà‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà 2      
   } //‡∏à‡∏ö if
}               
 
//=================‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå======================= 
function sendLineNotify(message,token) { //‡∏ä‡∏∏‡∏î‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå
    var options = {
        "method": "post",
        "payload": "message=" + message,
        "headers": {
            "Authorization": "Bearer " + token
        }
    };
 
    UrlFetchApp.fetch("https://notify-api.line.me/api/notify", options);
}


##################
https://docs.google.com/spreadsheets/d/1i5bhrDzyq2LFxWe-mQ-uKiimrdc58T63nbKsfHTpMGI/edit#gid=464951890
https://docs.google.com/spreadsheets/d/1i5bhrDzyq2LFxWe-mQ-uKiimrdc58T63nbKsfHTpMGI/edit#gid=464951890
